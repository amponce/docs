---
title: "File Upload"
description: "Upload and process documents for knowledge base indexing."
---

Upload documents to your knowledge base to give your agent access to your own data. Relay Agent parses, chunks, embeds, and indexes your files automatically.

## Supported File Formats

| Format | MIME Type | Notes |
|--------|-----------|-------|
| PDF | `application/pdf` | Text extraction from PDF documents |
| DOCX | `application/vnd.openxmlformats-officedocument.wordprocessingml.document` | Microsoft Word documents |
| TXT | `text/plain` | Plain text files |
| Markdown | `text/markdown` | Markdown files |
| CSV | `text/csv` | Comma-separated values |
| HTML | `text/html` | HTML pages (text extracted) |

**Maximum file size**: 50 MB per file.

## Upload via API (Multipart)

The recommended approach is to upload files directly using the multipart upload endpoint. Relay Agent handles parsing, chunking, and embedding automatically.

<Tabs items={["cURL", "SDK"]}>
<Tab value="cURL">
```bash
curl -X POST https://api.relay-agent.com/v1/knowledge-bases/kb_abc123/files/upload \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -F "file=@/path/to/document.pdf"
```
</Tab>
<Tab value="SDK">
```typescript
const file = await client.knowledgeBases.uploadFile('kb_abc123', {
  file: fs.createReadStream('/path/to/document.pdf'),
});
```
</Tab>
</Tabs>

The response includes the file record with processing status:

```json
{
  "id": "kbf_xyz789",
  "knowledgeBaseId": "kb_abc123",
  "filename": "document.pdf",
  "mimeType": "application/pdf",
  "sizeBytes": 245760,
  "chunkCount": 0,
  "status": "processing",
  "createdAt": "2026-02-08T12:00:00Z"
}
```

<Callout type="info">
  The file upload endpoint is rate-limited to 10 requests per minute per organization.
</Callout>

## Upload via API (JSON Content)

You can also upload pre-extracted text content as JSON. This is useful when you have already parsed the file or want to index text from a non-file source (e.g., a CMS, database, or API).

```bash
curl -X POST https://api.relay-agent.com/v1/knowledge-bases/kb_abc123/files \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "filename": "faq.txt",
    "mimeType": "text/plain",
    "content": "Q: What is your return policy?\nA: You can return any item within 30 days of purchase for a full refund.\n\nQ: How do I track my order?\nA: Log in to your account and visit the Orders page to see tracking information."
  }'
```

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `filename` | `string` | Yes | Display name for the file. 1-500 characters. |
| `mimeType` | `string` | Yes | MIME type of the content. |
| `sizeBytes` | `number` | No | File size in bytes. Auto-calculated from content if omitted. |
| `content` | `string` | No | Pre-extracted text content. If provided, the file is immediately queued for processing. |

## Processing Pipeline

When a file is uploaded, it goes through an asynchronous processing pipeline:

```
Upload -> Parse -> Chunk -> Embed -> Index
```

1. **Parse**: The file is converted to plain text. PDFs are extracted using pdf-parse, DOCX files using mammoth, and text-based formats (TXT, MD, CSV, HTML) are read directly as UTF-8.

2. **Chunk**: The text is split into chunks based on the knowledge base's `chunkSize` and `chunkOverlap` settings. Chunks are split at natural boundaries (paragraphs, sentences) when possible.

3. **Embed**: Each chunk is embedded into a 1536-dimensional vector using the configured embedding model (default: `text-embedding-3-small`).

4. **Index**: The embeddings are stored in pgvector for fast similarity search.

Processing happens asynchronously via a BullMQ job queue. The file's `status` field tracks progress:

| Status | Description |
|--------|-------------|
| `processing` | File is being parsed, chunked, and embedded. |
| `ready` | Processing complete. Chunks are indexed and available for retrieval. |
| `error` | Processing failed. Check `errorMessage` for details. |

## Upload via Admin Console

The admin console provides a drag-and-drop file upload interface:

1. Navigate to **Knowledge Bases** in the sidebar.
2. Select or create a knowledge base.
3. Click **Upload Files** or drag files into the upload area.
4. Monitor processing status in the file list.

## Checking File Status

Poll the file list to check processing status:

```bash
curl https://api.relay-agent.com/v1/knowledge-bases/kb_abc123/files \
  -H "Authorization: Bearer YOUR_API_KEY"
```

Response:

```json
[
  {
    "id": "kbf_xyz789",
    "knowledgeBaseId": "kb_abc123",
    "filename": "product-manual.pdf",
    "mimeType": "application/pdf",
    "sizeBytes": 245760,
    "chunkCount": 48,
    "status": "ready",
    "createdAt": "2026-02-08T12:00:00Z"
  },
  {
    "id": "kbf_abc456",
    "knowledgeBaseId": "kb_abc123",
    "filename": "faq.md",
    "mimeType": "text/markdown",
    "sizeBytes": 8192,
    "chunkCount": 12,
    "status": "ready",
    "createdAt": "2026-02-08T12:05:00Z"
  }
]
```

## Deleting a File

Remove a file and all its indexed chunks:

```bash
curl -X DELETE https://api.relay-agent.com/v1/knowledge-bases/kb_abc123/files/kbf_xyz789 \
  -H "Authorization: Bearer YOUR_API_KEY"
```

<Callout type="warn">
  Deleting a file permanently removes all its chunks and embeddings from the index. This cannot be undone. The knowledge base's `fileCount` and `totalChunks` counters update accordingly.
</Callout>

## Best Practices

- **Keep files focused**: Upload separate files for different topics rather than one massive document. This improves chunk relevance.
- **Use descriptive filenames**: Filenames are stored as metadata and can help with debugging retrieval issues.
- **Test after upload**: Use the [query endpoint](/build/knowledge-bases#testing-retrieval) to verify chunks are being retrieved correctly before connecting the knowledge base to a live agent.
- **Monitor chunk counts**: If a file produces too many or too few chunks, adjust the `chunkSize` setting on the knowledge base.
- **Prefer text formats**: Plain text and Markdown files parse the cleanest. PDFs with complex layouts (tables, multi-column) may lose formatting during extraction.
